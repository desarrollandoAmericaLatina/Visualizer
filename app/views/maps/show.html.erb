<%= render :partial => "shared/header" %>
<% javascript_include_tag 'ui.js' %>
<script>
  $(function(){
    $("#menu").draggable();
    $("#datasets").draggable();
  });

  <% if @dataset %>
    window.datasetRanges = <%= @dataset.values.to_json.html_safe %>;
    window.datasetDefaultColumn = '<%= @dataset.default_column_name %>';
    window.datasetCircleRadius = 100;
  <% end %>
</script>
<%= debug @dataset.to_param %>
<div class='tiles-map' id="<%= @dataset.try :to_param %>"></div>
<div id='datasets'>
  <h2>
    Datasets
  </h2>
  <ul>
    <% @datasets.each do |dataset|%>
      <li>
      <%= link_to dataset.name, dataset %>
      </li>
    <%end%>
  </ul>

</div>

<%= render :partial => "shared/side_menu" %>

<div id='menu'>

  <div id='config' class='item'>
    <h2>Configuration</h2>
    <ul>
      <% @attributes.try :each do |attr|%>
        <li>
          <input name="attribute" type="radio" value="<%= attr %>">
            <label for="attribute"><%= attr %></label>
          </input> 
        </li>
      <%end %>
    </ul>
    <% if @dataset.present? %>
      <div id='cross_matcher'>
        <div id='form_x_match'><h3>Add a cross match</h3>
          <form accept-charset='UTF-8' action="/datasets/<%= @dataset.id %>/add" enctype='multipart/form-data' method='post'>

            <select name="matcher-1">
              <% for attr in @attributes%>
                <option value="<%= attr %>"><%= attr %></option>
              <% end %>
            </select>

            <select name="matcher-2">
              <% for attr in @attributes%>
                <option value="<%= attr %>"><%= attr %></option>
              <% end %>
            </select>

            <input type='text' name='name' /><input name='commit' type='submit' value='Add'>
          </div>
        </form>
      </div>
    <% end %>

  </div>

  <div id='new' class='item'>
    <div id='step' class='item'>
      <h2>Upload your CSV file</h2>
    </div>
    <div id='action'>
      <%= render 'uploaded_files/form'%>
    </div>
    <div id='loader'>
      <%= image_tag 'ajax-loader.gif' %>
    </div>

  </div>


  <div id='share' class='item'>
    <h2>Share it</h2>
    <ul>
    </ul>
  </div>
</div>

